name: CI - Template

# TODO: Customize this workflow for your project
#
# This is a minimal CI template based on bobs-brain patterns.
# See bobs-brain/.github/workflows/ci.yml for full implementation.

on:
  push:
    branches: [ main, develop, 'feature/**' ]
  pull_request:
    branches: [ main, develop ]

jobs:
  # R8: Drift detection MUST run first
  drift-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Run drift detection
        run: |
          # TODO: Implement drift detection
          echo "Drift detection not configured yet"
          # bash scripts/ci/check_nodrift.sh

  # Versioning check (Phase 37)
  versioning-check:
    runs-on: ubuntu-latest
    needs: drift-check
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Full clone for tags

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Check versioning
        run: |
          # TODO: Copy check_versioning.py from bobs-brain
          echo "Versioning check not configured yet"
          # python scripts/check_versioning.py

  # ARV checks
  arv-check:
    runs-on: ubuntu-latest
    needs: drift-check
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt || echo "Requirements not found"

      - name: Run ARV checks
        run: |
          # TODO: Implement ARV checks
          echo "ARV checks not configured yet"
          # make check-arv-minimum

  # Code quality
  lint:
    runs-on: ubuntu-latest
    needs: drift-check
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install linters
        run: pip install flake8 black

      - name: Run linting
        run: |
          # TODO: Update paths for your project
          # flake8 agents/ service/ --count --select=E9,F63,F7,F82 --show-source --statistics
          echo "Linting not configured yet"

  # Tests
  test:
    runs-on: ubuntu-latest
    needs: drift-check
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt || echo "Requirements not found"
          pip install pytest pytest-cov

      - name: Run tests
        run: |
          # TODO: Add tests
          # pytest tests/ -v
          echo "Tests not configured yet"

  # Documentation check (R6)
  documentation-check:
    runs-on: ubuntu-latest
    needs: drift-check
    steps:
      - uses: actions/checkout@v4

      - name: Check required documentation
        run: |
          # R6: Verify 000-docs/ exists
          test -d 000-docs/ || { echo "❌ 000-docs/ not found (R6)"; exit 1; }

          # Required files
          test -f README.md || { echo "❌ README.md missing"; exit 1; }
          # test -f CLAUDE.md || { echo "❌ CLAUDE.md missing"; exit 1; }
          # test -f VERSION || { echo "❌ VERSION missing"; exit 1; }

          echo "✅ Documentation checks passed"

  # Summary
  ci-success:
    runs-on: ubuntu-latest
    needs: [drift-check, versioning-check, arv-check, lint, test, documentation-check]
    steps:
      - name: CI Success
        run: |
          echo "✅ All CI checks passed"
          echo ""
          echo "TODO: Implement remaining checks from bobs-brain"
